(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[293],{2318:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(9946).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},3067:(e,s,a)=>{Promise.resolve().then(a.bind(a,5353))},5353:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var l=a(5155),t=a(2115),r=a(285),i=a(7550),n=a(2318),o=a(9869),d=a(5060),c=a(4615),m=a(6821),p=a(983),u=a(3464),x=a(5695),h=a(638),f=a(4752),b=a.n(f);function j(){let e=(0,x.useRouter)(),s=(0,t.useRef)(),[a,p]=(0,t.useState)(!1),[f,j]=(0,t.useState)({name:"",email:"",password:"",password_confirmation:"",role:"user",active:!0,profile_photo:null}),g=e=>{let{name:s,value:a,type:l,checked:t}=e.target;j(e=>({...e,[s]:"checkbox"===l?t:a}))},v=async s=>{s.preventDefault(),p(!0);try{let s=sessionStorage.getItem("token"),a=new FormData;a.append("name",f.name),a.append("email",f.email),a.append("password",f.password),a.append("password_confirmation",f.password_confirmation),a.append("role",f.role),a.append("active",f.active?"1":"0"),f.profile_photo&&a.append("profile_photo",f.profile_photo);let l=await u.A.post((0,h.e9)("/users"),a,{headers:{Authorization:"Bearer ".concat(s),"Content-Type":"multipart/form-data",Accept:"application/json"}});if(l.data.status)b().fire({icon:"success",title:"Succ\xe8s",text:l.data.message||"Utilisateur cr\xe9\xe9 avec succ\xe8s"}),e.push("/dashboard");else throw Error(l.data.message||"Erreur lors de la cr\xe9ation")}catch(s){var a,l,t,r;console.error("Erreur cr\xe9ation utilisateur:",s);let e="Erreur lors de la cr\xe9ation de l'utilisateur";(null==(l=s.response)||null==(a=l.data)?void 0:a.errors)?e=Object.values(s.response.data.errors).flat().join(", "):(null==(r=s.response)||null==(t=r.data)?void 0:t.message)&&(e=s.response.data.message),b().fire({icon:"error",title:"Erreur",text:e})}finally{p(!1)}};return(0,l.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,l.jsx)(d.A,{}),(0,l.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,l.jsx)(c.A,{}),(0,l.jsx)("main",{className:"flex-1 p-6 overflow-auto",children:(0,l.jsxs)("div",{className:"mx-auto max-w-4xl px-2 sm:px-4 md:px-8 pt-8 pb-2",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Cr\xe9er un Utilisateur"}),(0,l.jsx)("div",{className:"text-muted-foreground text-base mt-1",children:"Ajouter un nouvel utilisateur au syst\xe8me"})]}),(0,l.jsxs)(r.$,{variant:"outline",onClick:()=>e.push("/dashboard"),disabled:a,className:"flex items-center gap-2",children:[(0,l.jsx)(i.A,{size:16}),"Retour"]})]}),(0,l.jsxs)("form",{onSubmit:v,className:"bg-white border rounded-xl p-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-3",children:"Photo de profil"}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full border flex items-center justify-center bg-gray-50 text-gray-400",children:f.profile_photo?(0,l.jsx)("img",{src:URL.createObjectURL(f.profile_photo),alt:"Preview",className:"w-full h-full rounded-full object-cover"}):(0,l.jsx)(n.A,{size:24,className:"sm:size-8"})}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-3",children:[(0,l.jsx)("input",{ref:s,type:"file",className:"hidden",accept:".jpeg,.png,.jpg,.gif",onChange:e=>{let s=e.target.files[0];if(s){if(s.size>2097152){b().fire({icon:"error",title:"Erreur",text:"La taille du fichier ne doit pas d\xe9passer 2MB"}),e.target.value="";return}if(!["image/jpeg","image/png","image/jpg","image/gif"].includes(s.type)){b().fire({icon:"error",title:"Erreur",text:"Format de fichier non support\xe9. Utilisez JPEG, PNG ou GIF"}),e.target.value="";return}j(e=>({...e,profile_photo:s}))}}}),(0,l.jsxs)(r.$,{type:"button",variant:"outline",onClick:()=>s.current.click(),disabled:a,className:"w-full sm:w-auto",children:[(0,l.jsx)(o.A,{size:16,className:"mr-2"}),"Choisir une photo"]}),(0,l.jsx)("span",{className:"text-xs text-muted-foreground text-center sm:text-left",children:".jpg/.png/.gif, 2Mo max."})]})]})]}),(0,l.jsxs)("div",{className:"md:col-span-2 sm:col-span-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Nom complet *"}),(0,l.jsx)("input",{type:"text",name:"name",required:!0,className:"w-full border rounded px-3 py-2 text-sm sm:text-base",placeholder:"Nom complet",value:f.name,onChange:g,disabled:a})]}),(0,l.jsxs)("div",{className:"md:col-span-2 sm:col-span-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Email *"}),(0,l.jsx)("input",{type:"email",name:"email",required:!0,className:"w-full border rounded px-3 py-2 text-sm sm:text-base",placeholder:"email@exemple.com",value:f.email,onChange:g,disabled:a})]}),(0,l.jsxs)("div",{className:"md:col-span-2 sm:col-span-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Mot de passe *"}),(0,l.jsx)("input",{type:"password",name:"password",required:!0,minLength:8,className:"w-full border rounded px-3 py-2 text-sm sm:text-base",placeholder:"Minimum 8 caract\xe8res",value:f.password,onChange:g,disabled:a})]}),(0,l.jsxs)("div",{className:"md:col-span-2 sm:col-span-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Confirmer le mot de passe *"}),(0,l.jsx)("input",{type:"password",name:"password_confirmation",required:!0,className:"w-full border rounded px-3 py-2 text-sm sm:text-base",placeholder:"Confirmer le mot de passe",value:f.password_confirmation,onChange:g,disabled:a})]}),(0,l.jsxs)("div",{className:"md:col-span-2 sm:col-span-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"R\xf4le *"}),(0,l.jsxs)("select",{name:"role",required:!0,className:"w-full border rounded px-3 py-2 text-sm sm:text-base",value:f.role,onChange:g,disabled:a,children:[(0,l.jsx)("option",{value:"user",children:"Utilisateur"}),(0,l.jsx)("option",{value:"admin",children:"Administrateur"})]})]}),(0,l.jsx)("div",{className:"md:col-span-2 sm:col-span-1 flex items-center pt-4",children:(0,l.jsxs)("label",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"checkbox",name:"active",className:"accent-primary size-4 sm:size-5",checked:f.active,onChange:g,disabled:a}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Utilisateur actif"})]})})]}),(0,l.jsx)("div",{className:"flex justify-end mt-8 pt-6 border-t",children:(0,l.jsx)(r.$,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2",disabled:a,children:a?(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Cr\xe9ation..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.A,{size:16,className:"mr-2"}),"Cr\xe9er l'Utilisateur"]})})})]})]})}),(0,l.jsx)(m.A,{})]})]})}function g(){return(0,l.jsx)(p.A,{children:(0,l.jsx)(j,{})})}},9869:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(9946).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[320,659,728,441,684,358],()=>s(3067)),_N_E=e.O()}]);