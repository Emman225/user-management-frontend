(()=>{var e={};e.id=907,e.ids=[907],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},13030:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>o.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d});var t=s(65239),a=s(48088),i=s(88170),o=s.n(i),l=s(30893),n={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);s.d(r,n);let d={children:["",{children:["dashboard",{children:["modifier",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,75167)),"D:\\Doc\\user-management-frontend\\src\\app\\dashboard\\modifier\\[id]\\page.jsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,94431)),"D:\\Doc\\user-management-frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["D:\\Doc\\user-management-frontend\\src\\app\\dashboard\\modifier\\[id]\\page.jsx"],p={require:s,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/dashboard/modifier/[id]/page",pathname:"/dashboard/modifier/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},16023:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(62688).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:e=>{"use strict";e.exports=require("os")},23026:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(62688).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},28559:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(62688).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},43152:(e,r,s)=>{Promise.resolve().then(s.bind(s,75167))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},60966:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>g});var t=s(60687),a=s(43210),i=s(29523),o=s(28559),l=s(23026),n=s(16023);let d=(0,s(62688).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var c=s(99154),p=s(21891),u=s(51317),m=s(56367),x=s(51060),h=s(16189),f=s(53360),b=s(77567);function j(){let e=(0,h.useRouter)(),r=(0,h.useParams)().id,s=(0,a.useRef)(),[m,j]=(0,a.useState)(!1),[g,v]=(0,a.useState)(!0),[y,N]=(0,a.useState)({name:"",email:"",password:"",password_confirmation:"",role:"user",active:!0,profile_photo:null,current_profile_photo:null}),w=e=>{let{name:r,value:s,type:t,checked:a}=e.target;N(e=>({...e,[r]:"checkbox"===t?a:s}))},_=async s=>{s.preventDefault(),j(!0);try{let s=sessionStorage.getItem("token"),t=new FormData;for(let[e,r]of(t.append("name",y.name),t.append("email",y.email),t.append("role",y.role),t.append("active",y.active?"1":"0"),y.password&&(t.append("password",y.password),t.append("password_confirmation",y.password_confirmation)),y.profile_photo&&t.append("profile_photo",y.profile_photo),t.append("_method","PUT"),console.log("Donn\xe9es envoy\xe9es \xe0 l'API (FormData):"),t.entries()))console.log(e,r);let a=await x.A.post((0,f.e9)(`/users/${r}`),t,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"multipart/form-data",Accept:"application/json"}});if(a.data.status)console.log("R\xe9ponse compl\xe8te de l'API:",JSON.stringify(a.data,null,2)),console.log("Donn\xe9es retourn\xe9es par l'API:",a.data.data),b.A.fire({icon:"success",title:"Succ\xe8s",text:a.data.message||"Utilisateur modifi\xe9 avec succ\xe8s"}),e.push("/dashboard");else throw console.log("R\xe9ponse API sans status true:",a.data),Error(a.data.message||"Erreur lors de la modification")}catch(r){console.error("Erreur modification utilisateur:",r);let e="Erreur lors de la modification de l'utilisateur";r.response?.data?.errors?e=Object.values(r.response.data.errors).flat().join(", "):r.response?.data?.message&&(e=r.response.data.message),b.A.fire({icon:"error",title:"Erreur",text:e})}finally{j(!1)}};return g?(0,t.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,t.jsx)(c.A,{}),(0,t.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,t.jsx)(p.A,{}),(0,t.jsx)("main",{className:"flex-1 p-6 overflow-auto flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),(0,t.jsx)(u.A,{})]})]}):(0,t.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,t.jsx)(c.A,{}),(0,t.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,t.jsx)(p.A,{}),(0,t.jsx)("main",{className:"flex-1 p-6 overflow-auto",children:(0,t.jsxs)("div",{className:"mx-auto max-w-4xl px-2 sm:px-4 md:px-8 pt-8 pb-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Modifier l'Utilisateur"}),(0,t.jsx)("div",{className:"text-muted-foreground text-base mt-1",children:"Modifier les informations de l'utilisateur"})]}),(0,t.jsxs)(i.$,{variant:"outline",onClick:()=>e.push("/dashboard"),disabled:m,className:"flex items-center gap-2",children:[(0,t.jsx)(o.A,{size:16}),"Retour"]})]}),(0,t.jsxs)("form",{onSubmit:_,className:"bg-white border rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-3",children:"Photo de profil"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full border flex items-center justify-center bg-gray-50 text-gray-400",children:y.profile_photo?(0,t.jsx)("img",{src:URL.createObjectURL(y.profile_photo),alt:"Preview",className:"w-20 h-20 rounded-full object-cover"}):y.current_profile_photo?(0,t.jsx)("img",{src:y.current_profile_photo,alt:"Current profile",className:"w-20 h-20 rounded-full object-cover"}):(0,t.jsx)(l.A,{size:32})}),(0,t.jsx)("input",{ref:s,type:"file",className:"hidden",accept:".jpeg,.png,.jpg,.gif",onChange:e=>{let r=e.target.files[0];if(r){if(r.size>2097152){b.A.fire({icon:"error",title:"Erreur",text:"La taille du fichier ne doit pas d\xe9passer 2MB"}),e.target.value="";return}if(!["image/jpeg","image/png","image/jpg","image/gif"].includes(r.type)){b.A.fire({icon:"error",title:"Erreur",text:"Format de fichier non support\xe9. Utilisez JPEG, PNG ou GIF"}),e.target.value="";return}N(e=>({...e,profile_photo:r}))}}}),(0,t.jsxs)(i.$,{type:"button",variant:"outline",onClick:()=>s.current.click(),disabled:m,children:[(0,t.jsx)(n.A,{size:16,className:"mr-2"}),y.current_profile_photo?"Changer la photo":"Choisir une photo"]}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:".jpg/.png/.gif, 2Mo max."})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Nom complet *"}),(0,t.jsx)("input",{type:"text",name:"name",required:!0,className:"w-full border rounded px-3 py-2",placeholder:"Nom complet",value:y.name,onChange:w,disabled:m})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Email *"}),(0,t.jsx)("input",{type:"email",name:"email",required:!0,className:"w-full border rounded px-3 py-2",placeholder:"email@exemple.com",value:y.email,onChange:w,disabled:m})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Nouveau mot de passe"}),(0,t.jsx)("input",{type:"password",name:"password",minLength:8,className:"w-full border rounded px-3 py-2",placeholder:"Laisser vide pour ne pas modifier",value:y.password,onChange:w,disabled:m})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Confirmer le nouveau mot de passe"}),(0,t.jsx)("input",{type:"password",name:"password_confirmation",className:"w-full border rounded px-3 py-2",placeholder:"Confirmer le nouveau mot de passe",value:y.password_confirmation,onChange:w,disabled:m})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"R\xf4le *"}),(0,t.jsxs)("select",{name:"role",required:!0,className:"w-full border rounded px-3 py-2",value:y.role,onChange:w,disabled:m,children:[(0,t.jsx)("option",{value:"user",children:"Utilisateur"}),(0,t.jsx)("option",{value:"admin",children:"Administrateur"})]})]}),(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",name:"active",className:"accent-primary",checked:y.active,onChange:w,disabled:m}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Utilisateur actif"})]})})]}),(0,t.jsx)("div",{className:"flex justify-end mt-8 pt-6 border-t",children:(0,t.jsx)(i.$,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2",disabled:m,children:m?(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Modification..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{size:16,className:"mr-2"}),"Modifier l'Utilisateur"]})})})]})]})}),(0,t.jsx)(u.A,{})]})]})}function g(){return(0,t.jsx)(m.A,{children:(0,t.jsx)(j,{})})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},75167:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>t});let t=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\Doc\\\\user-management-frontend\\\\src\\\\app\\\\dashboard\\\\modifier\\\\[id]\\\\page.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Doc\\user-management-frontend\\src\\app\\dashboard\\modifier\\[id]\\page.jsx","default")},78e3:(e,r,s)=>{Promise.resolve().then(s.bind(s,60966))},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},94735:e=>{"use strict";e.exports=require("events")}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[825,873,567,653],()=>s(13030));module.exports=t})();